<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Distributed-Denial-of-Service Open Threat Signaling (DOTS) Architecture</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Context and Motivation">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.1.1.1" rel="Chapter" title="1.1.1 Key Words">
<link href="#rfc.section.1.1.2" rel="Chapter" title="1.1.2 Definition of Terms">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Scope">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Assumptions">
<link href="#rfc.section.2" rel="Chapter" title="2 DOTS Architecture">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 DOTS Operations">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Components">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 DOTS Client">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 DOTS Server">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 DOTS Gateway">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 DOTS Agent Relationships">
<link href="#rfc.section.2.3.1" rel="Chapter" title="2.3.1 Gatewayed Signaling">
<link href="#rfc.section.3" rel="Chapter" title="3 Concepts">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 DOTS Sessions">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Preconditions">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Establishing the DOTS Session">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 Maintaining the DOTS Session">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Modes of Signaling">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Direct Signaling">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Redirected Signaling">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Recursive Signaling">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 Anycast Signaling">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Signaling Considerations for Network Address Translation">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Triggering Requests for Mitigation">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Manual Mitigation Request">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Automated Conditional Mitigation Request">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 Automated Mitigation on Loss of Signal">
<link href="#rfc.section.4" rel="Chapter" title="4 IANA Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Contributors">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.22.3 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Mortensen, A., Ed., Reddy, T., Ed., Andreasen, F., Teague, N., and R. Compton" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-dots-architecture-14" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-05-29" />
  <meta name="dct.abstract" content="This document describes an architecture for establishing and maintaining Distributed Denial of Service (DDoS) Open Threat Signaling (DOTS) within and between domains. The document does not specify protocols or protocol extensions, instead focusing on defining architectural relationships, components and concepts used in a DOTS deployment." />
  <meta name="description" content="This document describes an architecture for establishing and maintaining Distributed Denial of Service (DDoS) Open Threat Signaling (DOTS) within and between domains. The document does not specify protocols or protocol extensions, instead focusing on defining architectural relationships, components and concepts used in a DOTS deployment." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">DOTS</td>
<td class="right">A. Mortensen, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Forcepoint</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">T. Reddy, Ed.</td>
</tr>
<tr>
<td class="left">Expires: November 30, 2019</td>
<td class="right">McAfee, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">F. Andreasen</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">N. Teague</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Iron Mountain</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">R. Compton</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Charter</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">May 29, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Distributed-Denial-of-Service Open Threat Signaling (DOTS) Architecture<br />
  <span class="filename">draft-ietf-dots-architecture-14</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes an architecture for establishing and maintaining Distributed Denial of Service (DDoS) Open Threat Signaling (DOTS) within and between domains. The document does not specify protocols or protocol extensions, instead focusing on defining architectural relationships, components and concepts used in a DOTS deployment.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 30, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Context and Motivation</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<ul><li>1.1.1.   <a href="#rfc.section.1.1.1">Key Words</a>
</li>
<li>1.1.2.   <a href="#rfc.section.1.1.2">Definition of Terms</a>
</li>
</ul><li>1.2.   <a href="#rfc.section.1.2">Scope</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Assumptions</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">DOTS Architecture</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">DOTS Operations</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Components</a>
</li>
<ul><li>2.2.1.   <a href="#rfc.section.2.2.1">DOTS Client</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">DOTS Server</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">DOTS Gateway</a>
</li>
</ul><li>2.3.   <a href="#rfc.section.2.3">DOTS Agent Relationships</a>
</li>
<ul><li>2.3.1.   <a href="#rfc.section.2.3.1">Gatewayed Signaling</a>
</li>
</ul></ul><li>3.   <a href="#rfc.section.3">Concepts</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">DOTS Sessions</a>
</li>
<ul><li>3.1.1.   <a href="#rfc.section.3.1.1">Preconditions</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Establishing the DOTS Session</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">Maintaining the DOTS Session</a>
</li>
</ul><li>3.2.   <a href="#rfc.section.3.2">Modes of Signaling</a>
</li>
<ul><li>3.2.1.   <a href="#rfc.section.3.2.1">Direct Signaling</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Redirected Signaling</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Recursive Signaling</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">Anycast Signaling</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Signaling Considerations for Network Address Translation</a>
</li>
</ul><li>3.3.   <a href="#rfc.section.3.3">Triggering Requests for Mitigation</a>
</li>
<ul><li>3.3.1.   <a href="#rfc.section.3.3.1">Manual Mitigation Request</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Automated Conditional Mitigation Request</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">Automated Mitigation on Loss of Signal</a>
</li>
</ul></ul><li>4.   <a href="#rfc.section.4">IANA Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Contributors</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgments</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<ul><li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#context-and-motivation" id="context-and-motivation">Context and Motivation</a>
</h1>
<p id="rfc.section.1.p.1">Signaling the need for help defending against an active distributed denial of service (DDoS) attack requires a common understanding of mechanisms and roles among the parties coordinating defensive response. The signaling layer and supplementary messaging is the focus of DDoS Open Threat Signaling (DOTS). DOTS defines a method of coordinating defensive measures among willing peers to mitigate attacks quickly and efficiently, enabling hybrid attack responses coordinated locally at or near the target of an active attack, or anywhere in-path between attack sources and target. Sample DOTS use cases are elaborated in <a href="#I-D.ietf-dots-use-cases" class="xref">[I-D.ietf-dots-use-cases]</a>.</p>
<p id="rfc.section.1.p.2">This document describes an architecture used in establishing, maintaining or terminating a DOTS relationship within a domain or between domains.</p>
<h2 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h2>
<h3 id="rfc.section.1.1.1">
<a href="#rfc.section.1.1.1">1.1.1.</a> <a href="#key-words" id="key-words">Key Words</a>
</h3>
<p id="rfc.section.1.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a>, when, and only when, they appear in all capitals.</p>
<h3 id="rfc.section.1.1.2">
<a href="#rfc.section.1.1.2">1.1.2.</a> <a href="#definition-of-terms" id="definition-of-terms">Definition of Terms</a>
</h3>
<p id="rfc.section.1.1.2.p.1">This document uses the terms defined in <a href="#RFC8612" class="xref">[RFC8612]</a>.</p>
<h2 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#scope" id="scope">Scope</a>
</h2>
<p id="rfc.section.1.2.p.1">In this architecture, DOTS clients and servers communicate using DOTS signaling.  As a result of signals from a DOTS client, the DOTS server may modify the forwarding path of traffic destined for the attack target(s), for example by diverting traffic to a mitigator or pool of mitigators, where policy may be applied to distinguish and discard attack traffic. Any such policy is deployment-specific.</p>
<p id="rfc.section.1.2.p.2">The DOTS architecture presented here is applicable across network administrative domains &#8211; for example, between an enterprise domain and the domain of a third-party attack mitigation service &#8211; as well as to a single administrative domain. DOTS is generally assumed to be most effective when aiding coordination of attack response between two or more participating networks, but single domain scenarios are valuable in their own right, as when aggregating intra-domain DOTS client signals for inter-domain coordinated attack response.</p>
<p id="rfc.section.1.2.p.3">This document does not address any administrative or business agreements that may be established between involved DOTS parties. Those considerations are out of scope. Regardless, this document assumes necessary authentication and authorization mechanisms are put in place so that only authorized clients can invoke the DOTS service.</p>
<p id="rfc.section.1.2.p.4">A detailed set of DOTS requirements are discussed in <a href="#RFC8612" class="xref">[RFC8612]</a>, and the DOTS architecture is designed to follow those requirements. Only new behavioral requirements are described in this document.</p>
<h2 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#assumptions" id="assumptions">Assumptions</a>
</h2>
<p id="rfc.section.1.3.p.1">This document makes the following assumptions:</p>
<p></p>

<ul>
<li>All domains in which DOTS is deployed are assumed to offer the required connectivity between DOTS agents and any intermediary network elements, but the architecture imposes no additional limitations on the form of connectivity.</li>
<li>Congestion and resource exhaustion are intended outcomes of a DDoS attack <a href="#RFC4732" class="xref">[RFC4732]</a>. Some operators may utilize non-impacted paths or networks for DOTS, but in general conditions should be assumed to be hostile and DOTS must be able to function in all circumstances, including when the signaling path is significantly impaired.</li>
<li>There is no universal DDoS attack scale threshold triggering a coordinated response across administrative domains. A network domain administrator, or service or application owner may arbitrarily set attack scale threshold triggers, or manually send requests for mitigation.</li>
<li>Mitigation requests may be sent to one or more upstream DOTS servers based on criteria determined by DOTS client administrators and the underlying network configuration. The number of DOTS servers with which a given DOTS client has established communications is determined by local policy and is deployment-specific. For example, a DOTS client of a multi-homed network may support built-in policies to establish DOTS relationships with DOTS servers located upstream of each interconnection link.</li>
<li>The mitigation capacity and/or capability of domains receiving requests for coordinated attack response is opaque to the domains sending the request. The domain receiving the DOTS client signal may or may not have sufficient capacity or capability to filter any or all DDoS attack traffic directed at a target. In either case, the upstream DOTS server may redirect a request to another DOTS server. Redirection may be local to the redirecting DOTS server's domain, or may involve a third-party domain.</li>
<li>DOTS client and server signals, as well as messages sent through the data channel, are sent across any transit networks with the same probability of delivery as any other traffic between the DOTS client domain and the DOTS server domain. Any encapsulation required for successful delivery is left untouched by transit network elements. DOTS server and DOTS client cannot assume any preferential treatment of DOTS signals. Such preferential treatment may be available in some deployments (e.g., intra-domain scenarios), and the DOTS architecture does not preclude its use when available. However, DOTS itself does not address how that may be done.</li>
<li>The architecture allows for, but does not assume, the presence of Quality of Service (QoS) policy agreements between DOTS-enabled peer networks or local QoS prioritization aimed at ensuring delivery of DOTS messages between DOTS agents. QoS is an operational consideration only, not a functional part of the DOTS architecture.</li>
<li>The signal and data channels are loosely coupled, and may not terminate on the same DOTS server.</li>
</ul>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#architecture" id="architecture">DOTS Architecture</a>
</h1>
<p id="rfc.section.2.p.1">The basic high-level DOTS architecture is illustrated in <a href="#fig-basic-arch" class="xref">Figure 1</a>:</p>
<div id="rfc.figure.1"></div>
<div id="fig-basic-arch"></div>
<pre>
    +-----------+            +-------------+
    | Mitigator | ~~~~~~~~~~ | DOTS Server |
    +-----------+            +-------------+
                                    |
                                    |
                                    |
    +---------------+        +-------------+
    | Attack Target | ~~~~~~ | DOTS Client |
    +---------------+        +-------------+
</pre>
<p class="figure">Figure 1: Basic DOTS Architecture</p>
<p id="rfc.section.2.p.2">A simple example instantiation of the DOTS architecture could be an enterprise as the attack target for a volumetric DDoS attack, and an upstream DDoS mitigation service as the mitigator. The enterprise (attack target) is connected to the Internet via a link that is getting saturated, and the enterprise suspects it is under DDoS attack. The enterprise has a DOTS client, which obtains information about the DDoS attack, and signals the DOTS server for help in mitigating the attack. The DOTS server in turn invokes one or more mitigators, which are tasked with mitigating the actual DDoS attack, and hence aim to suppress the attack traffic while allowing valid traffic to reach the attack target.</p>
<p id="rfc.section.2.p.3">The scope of the DOTS specifications is the interfaces between the DOTS client and DOTS server. The interfaces to the attack target and the mitigator are out of scope of DOTS. Similarly, the operation of both the attack target and the mitigator is out of scope of DOTS. Thus, DOTS neither specifies how an attack target decides it is under DDoS attack, nor does DOTS specify how a mitigator may actually mitigate such an attack. A DOTS client's request for mitigation is advisory in nature, and may not lead to any mitigation at all, depending on the DOTS server domain's capacity and willingness to mitigate on behalf of the DOTS client's domain.</p>
<p id="rfc.section.2.p.4">The DOTS client may be provided with a list of DOTS servers, each associated with one or more IP addresses. These addresses may or may not be of the same address family. The DOTS client establishes one or more sessions by connecting to the provided DOTS server addresses.</p>
<p id="rfc.section.2.p.5">As illustrated in <a href="#fig-interfaces" class="xref">Figure 2</a>, there are two interfaces between a DOTS server and a DOTS client; a signal channel and (optionally) a data channel.</p>
<div id="rfc.figure.2"></div>
<div id="fig-interfaces"></div>
<pre>
    +---------------+                                 +---------------+
    |               | &lt;------- Signal Channel ------&gt; |               |
    |  DOTS Client  |                                 |  DOTS Server  |
    |               | &lt;=======  Data Channel  ======&gt; |               |
    +---------------+                                 +---------------+
</pre>
<p class="figure">Figure 2: DOTS Interfaces</p>
<p id="rfc.section.2.p.6">The primary purpose of the signal channel is for a DOTS client to ask a DOTS server for help in mitigating an attack, and for the DOTS server to inform the DOTS client about the status of such mitigation. The DOTS client does this by sending a client signal, which contains information about the attack target(s). The client signal may also include telemetry information about the attack, if the DOTS client has such information available. The DOTS server in turn sends a server signal to inform the DOTS client of whether it will honor the mitigation request. Assuming it will, the DOTS server initiates attack mitigation, and periodically informs the DOTS client about the status of the mitigation.  Similarly, the DOTS client periodically informs the DOTS server about the client's status, which at a minimum provides client (attack target) health information, but it should also include efficacy information about the attack mitigation as it is now seen by the client. At some point, the DOTS client may decide to terminate the server-side attack mitigation, which it indicates to the DOTS server over the signal channel. A mitigation may also be terminated if a DOTS client-specified mitigation lifetime is exceeded. Note that the signal channel may need to operate over a link that is experiencing a DDoS attack and hence is subject to severe packet loss and high latency.</p>
<p id="rfc.section.2.p.7">While DOTS is able to request mitigation with just the signal channel, the addition of the DOTS data channel provides for additional and more efficient capabilities. The primary purpose of the data channel is to support DOTS related configuration and policy information exchange between the DOTS client and the DOTS server. Examples of such information include, but are not limited to:</p>
<p></p>

<ul><li>Creating identifiers, such as names or aliases, for resources for which mitigation may be requested. Such identifiers may then be used in subsequent signal channel exchanges to refer more efficiently to the resources under attack, as seen in <a href="#fig-resource-identifiers" class="xref">Figure 3</a>, using JSON to serialize the data:</li></ul>
<div id="rfc.figure.3"></div>
<div id="fig-resource-identifiers"></div>
<pre>
        {
            "https1": [
                "192.0.2.1:443",
                "198.51.100.2:443",
            ],
            "proxies": [
                "203.0.113.3:3128",
                "[2001:db8:ac10::1]:3128"
            ],
            "api_urls": "https://apiserver.example.com/api/v1",
        }
</pre>
<p class="figure">Figure 3: Protected resource identifiers</p>
<p></p>

<ul>
<li>Drop-list management, which enables a DOTS client to inform the DOTS server about sources to suppress.</li>
<li>Accept-list management, which enables a DOTS client to inform the DOTS server about sources from which traffic is always accepted.</li>
<li>Filter management, which enables a DOTS client to install or remove traffic filters dropping or rate-limiting unwanted traffic.</li>
<li>DOTS client provisioning.</li>
</ul>
<p id="rfc.section.2.p.10">Note that while it is possible to exchange the above information before, during or after a DDoS attack, DOTS requires reliable delivery of this information and does not provide any special means for ensuring timely delivery of it during an attack. In practice, this means that DOTS deployments should not rely on such information being exchanged during a DDoS attack.</p>
<h2 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#operations" id="operations">DOTS Operations</a>
</h2>
<p id="rfc.section.2.1.p.1">DOTS does not prescribe any specific deployment models, however DOTS is designed with some specific requirements around the different DOTS agents and their relationships.</p>
<p id="rfc.section.2.1.p.2">First of all, a DOTS agent belongs to a domain that has an identity which can be authenticated and authorized. DOTS agents communicate with each other over a mutually authenticated signal channel and (optionally) data channel. However, before they can do so, a service relationship needs to be established between them.  The details and means by which this is done is outside the scope of DOTS, however an example would be for an enterprise A (DOTS client) to sign up for DDoS service from provider B (DOTS server). This would establish a (service) relationship between the two that enables enterprise A's DOTS client to establish a signal channel with provider B's DOTS server. A and B will authenticate each other, and B can verify that A is authorized for its service.</p>
<p id="rfc.section.2.1.p.3">From an operational and design point of view, DOTS assumes that the above relationship is established prior to a request for DDoS attack mitigation. In particular, it is assumed that bi-directional communication is possible at this time between the DOTS client and DOTS server. Furthermore, it is assumed that additional service provisioning, configuration and information exchange can be performed by use of the data channel, if operationally required. It is not until this point that the mitigation service is available for use.</p>
<p id="rfc.section.2.1.p.4">Once the mutually authenticated signal channel has been established, it will remain active. This is done to increase the likelihood that the DOTS client can signal the DOTS server for help when the attack target is being flooded, and similarly raise the probability that DOTS server signals reach the client regardless of inbound link congestion.  This does not necessarily imply that the attack target and the DOTS client have to be co-located in the same administrative domain, but it is expected to be a common scenario.</p>
<p id="rfc.section.2.1.p.5">DDoS mitigation with the help of an upstream mitigator may involve some form of traffic redirection whereby traffic destined for the attack target is steered towards the mitigator. Common mechanisms to achieve this redirection depend on BGP <a href="#RFC4271" class="xref">[RFC4271]</a> and DNS <a href="#RFC1035" class="xref">[RFC1035]</a>. The mitigator in turn inspects and scrubs the traffic, and forwards the resulting (hopefully non-attack) traffic to the attack target. Thus, when a DOTS server receives an attack mitigation request from a DOTS client, it can be viewed as a way of causing traffic redirection for the attack target indicated.</p>
<p id="rfc.section.2.1.p.6">DOTS relies on mutual authentication and the pre-established service relationship between the DOTS client's domain and the DOTS server's domain to provide basic authorization. The DOTS server should enforce additional authorization mechanisms to restrict the mitigation scope a DOTS client can request, but such authorization mechanisms are deployment-specific.</p>
<p id="rfc.section.2.1.p.7">Although co-location of DOTS server and mitigator within the same domain is expected to be a common deployment model, it is assumed that operators may require alternative models. Nothing in this document precludes such alternatives.</p>
<h2 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#components" id="components">Components</a>
</h2>
<h3 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> <a href="#dots-client" id="dots-client">DOTS Client</a>
</h3>
<p id="rfc.section.2.2.1.p.1">A DOTS client is a DOTS agent from which requests for help coordinating attack response originate. The requests may be in response to an active, ongoing attack against a target in the DOTS client's domain, but no active attack is required for a DOTS client to request help. Operators may wish to have upstream mitigators in the network path for an indefinite period, and are restricted only by business relationships when it comes to duration and scope of requested mitigation.</p>
<p id="rfc.section.2.2.1.p.2">The DOTS client requests attack response coordination from a DOTS server over the signal channel, including in the request the DOTS client's desired mitigation scoping, as described in <a href="#RFC8612" class="xref">[RFC8612]</a>  (SIG-008). The actual mitigation scope and countermeasures used in response to the attack are up to the DOTS server and mitigator operators, as the DOTS client may have a narrow perspective on the ongoing attack. As such, the DOTS client's request for mitigation should be considered advisory: guarantees of DOTS server availability or mitigation capacity constitute service level agreements and are out of scope for this document.</p>
<p id="rfc.section.2.2.1.p.3">The DOTS client adjusts mitigation scope and provides available mitigation feedback (e.g., mitigation efficacy) at the direction of its local administrator. Such direction may involve manual or automated adjustments in response to updates from the DOTS server.</p>
<p id="rfc.section.2.2.1.p.4">To provide a metric of signal health and distinguish an idle signal channel from a disconnected or defunct session, the DOTS client sends a heartbeat over the signal channel to maintain its half of the channel. The DOTS client similarly expects a heartbeat from the DOTS server, and may consider a session terminated in the extended absence of a DOTS server heartbeat.</p>
<h3 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> <a href="#dots-server" id="dots-server">DOTS Server</a>
</h3>
<p id="rfc.section.2.2.2.p.1">A DOTS server is a DOTS agent capable of receiving, processing and possibly acting on requests for help coordinating attack response from DOTS clients.  The DOTS server authenticates and authorizes DOTS clients as described in <a href="#dots-sessions" class="xref">Section 3.1</a>, and maintains session state, tracking requests for mitigation, reporting on the status of active mitigations, and terminating sessions in the extended absence of a client heartbeat or when a session times out.</p>
<p id="rfc.section.2.2.2.p.2">Assuming the preconditions discussed below exist, a DOTS client maintaining an active session with a DOTS server may reasonably expect some level of mitigation in response to a request for coordinated attack response.</p>
<p id="rfc.section.2.2.2.p.3">For a given DOTS client (administrative) domain, the DOTS server needs to be able to determine whether a given target resource is in that domain. For example, this could take the form of associating a set of IP addresses and/or prefixes per domain.  The DOTS server enforces authorization of DOTS clients' signals for mitigation.  The mechanism of enforcement is not in scope for this document, but is expected to restrict requested mitigation scope to addresses, prefixes, and/or services owned by the DOTS client domain, such that a DOTS client from one domain is not able to influence the network path to another domain. A DOTS server MUST reject requests for mitigation of resources not owned by the requesting DOTS client's administrative domain. A DOTS server MAY also refuse a DOTS client's mitigation request for arbitrary reasons, within any limits imposed by business or service level agreements between client and server domains. If a DOTS server refuses a DOTS client's request for mitigation, the DOTS server MUST include the refusal reason in the server signal sent to the client.</p>
<p id="rfc.section.2.2.2.p.4">A DOTS server is in regular contact with one or more mitigators. If a DOTS server accepts a DOTS client's request for help, the DOTS server forwards a translated form of that request to the mitigator(s) responsible for scrubbing attack traffic. Note that the form of the translated request passed from the DOTS server to the mitigator is not in scope: it may be as simple as an alert to mitigator operators, or highly automated using vendor or open application programming interfaces supported by the mitigator. The DOTS server MUST report the actual scope of any mitigation enabled on behalf of a client.</p>
<p id="rfc.section.2.2.2.p.5">The DOTS server SHOULD retrieve available metrics for any mitigations activated on behalf of a DOTS client, and SHOULD include them in server signals sent to the DOTS client originating the request for mitigation.</p>
<p id="rfc.section.2.2.2.p.6">To provide a metric of signal health and distinguish an idle signal channel from a disconnected or defunct channel, the DOTS server MUST send a heartbeat over the signal channel to maintain its half of the channel. The DOTS server similarly expects a heartbeat from the DOTS client, and MAY consider a session terminated in the extended absence of a DOTS client heartbeat.</p>
<h3 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> <a href="#dots-gateway" id="dots-gateway">DOTS Gateway</a>
</h3>
<p id="rfc.section.2.2.3.p.1">Traditional client/server relationships may be expanded by chaining DOTS sessions. This chaining is enabled through "logical concatenation" of a DOTS server and a DOTS client, resulting in an application analogous to the Session Initiation Protocol (SIP) <a href="#RFC3261" class="xref">[RFC3261]</a> logical entity of a Back-to-Back User Agent (B2BUA) <a href="#RFC7092" class="xref">[RFC7092]</a>. The term DOTS gateway is used here in the descriptions of selected scenarios involving this application.</p>
<p id="rfc.section.2.2.3.p.2">A DOTS gateway may be deployed client-side, server-side or both.  The gateway may terminate multiple discrete client connections and may aggregate these into a single or multiple DOTS sessions.</p>
<p id="rfc.section.2.2.3.p.3">The DOTS gateway will appear as a server to its downstream agents and as a client to its upstream agents, a functional concatenation of the DOTS client and server roles, as depicted in <a href="#fig-dots-gateway" class="xref">Figure 4</a>:</p>
<div id="rfc.figure.4"></div>
<div id="fig-dots-gateway"></div>
<pre>
                      +-------------+
                      |    | D |    |
      +----+          |    | O |    |         +----+
      | c1 |----------| s1 | T | c2 |---------| s2 |
      +----+          |    | S |    |         +----+
                      |    | G |    |
                      +-------------+
</pre>
<p class="figure">Figure 4: DOTS gateway</p>
<p id="rfc.section.2.2.3.p.4">The DOTS gateway MUST perform full stack DOTS session termination and reorigination between its client and server side. The details of how this is achieved are implementation specific. The DOTS protocol does not include any special features related to DOTS gateways, and hence from a DOTS perspective, whenever a DOTS gateway is present, the DOTS session simply terminates/originates there.</p>
<h2 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#agent-relationships" id="agent-relationships">DOTS Agent Relationships</a>
</h2>
<p id="rfc.section.2.3.p.1">So far, we have only considered a relatively simple scenario of a single DOTS client associated with a single DOTS server, however DOTS supports more advanced relationships.</p>
<p id="rfc.section.2.3.p.2">A DOTS server may be associated with one or more DOTS clients, and those DOTS clients may belong to different domains. An example scenario is a mitigation provider serving multiple attack targets (<a href="#fig-multi-client-server" class="xref">Figure 5</a>).</p>
<div id="rfc.figure.5"></div>
<div id="fig-multi-client-server"></div>
<pre>
   DOTS clients       DOTS server
   +---+
   | c |-----------
   +---+           \
   c1.example.org   \
                     \
   +---+              \ +---+
   | c |----------------| S |
   +---+              / +---+
   c1.example.com    /  dots1.example.net
                    /
   +---+           /
   | c |-----------
   +---+
   c2.example.com
</pre>
<p class="figure">Figure 5: DOTS server with multiple clients</p>
<p id="rfc.section.2.3.p.3">A DOTS client may be associated with one or more DOTS servers, and those DOTS servers may belong to different domains.  This may be to ensure high availability or co-ordinate mitigation with more than one directly connected ISP.  An example scenario is for an enterprise to have DDoS mitigation service from multiple providers, as shown in <a href="#fig-multi-homed-client" class="xref">Figure 6</a>.</p>
<div id="rfc.figure.6"></div>
<div id="fig-multi-homed-client"></div>
<pre>
   DOTS client        DOTS servers
                       +---+
            -----------| S |
           /           +---+
          /            dots1.example.net
         /
   +---+/              +---+
   | c |---------------| S |
   +---+\              +---+
         \             dots.example.org
          \
           \           +---+
            -----------| S |
                       +---+
   c.example.com       dots2.example.net
</pre>
<p class="figure">Figure 6: Multi-Homed DOTS Client</p>
<p id="rfc.section.2.3.p.4">Deploying a multi-homed client requires extra care and planning, as the DOTS servers with which the multi-homed client communicates may not be affiliated.  Should the multi-homed client simultaneously request for mitigation from all servers with which it has established signal channels, the client may unintentionally inflict additional network disruption on the resources it intends to protect. In one of the worst cases, a multi-homed DOTS client could cause a permanent routing loop of traffic destined for the client's protected services, as the uncoordinated DOTS servers' mitigators all try to divert that traffic to their own scrubbing centers.</p>
<p id="rfc.section.2.3.p.5">The DOTS protocol itself provides no fool-proof method to prevent such self-inflicted harms as a result deploying multi-homed DOTS clients. If DOTS client implementations nevertheless include support for multi-homing, they are expected to be aware of the risks, and consequently to include measures aimed at reducing the likelihood of negative outcomes. Simple measures might include:</p>
<p></p>

<ul>
<li>Requesting mitigation serially, ensuring only one mitigation request for a given address space is active at any given time;</li>
<li>Dividing the protected resources among the DOTS servers, such that no two mitigators will be attempting to divert and scrub the same traffic;</li>
<li>Restricting multi-homing to deployments in which all DOTS servers are coordinating management of a shared pool of mitigation resources.</li>
</ul>
<h3 id="rfc.section.2.3.1">
<a href="#rfc.section.2.3.1">2.3.1.</a> <a href="#gatewayed-signaling" id="gatewayed-signaling">Gatewayed Signaling</a>
</h3>
<p id="rfc.section.2.3.1.p.1">As discussed in <a href="#dots-gateway" class="xref">Section 2.2.3</a>, a DOTS gateway is a logical function chaining DOTS sessions through concatenation of a DOTS server and DOTS client.</p>
<p id="rfc.section.2.3.1.p.2">An example scenario, as shown in <a href="#fig-client-gateway-agg" class="xref">Figure 7</a> and <a href="#fig-client-gateway-noagg" class="xref">Figure 8</a>, is for an enterprise to have deployed multiple DOTS capable devices which are able to signal intra-domain using TCP <a href="#RFC0793" class="xref">[RFC0793]</a> on un-congested links to a DOTS gateway which may then transform these to a UDP <a href="#RFC0768" class="xref">[RFC0768]</a> transport inter-domain where connection oriented transports may degrade; this applies to the signal channel only, as the data channel requires a connection-oriented transport. The relationship between the gateway and its upstream agents is opaque to the initial clients.</p>
<div id="rfc.figure.7"></div>
<div id="fig-client-gateway-agg"></div>
<pre>
      +---+
      | c |\
      +---+ \              +---+
             \-----TCP-----| D |               +---+
      +---+                | O |               |   |
      | c |--------TCP-----| T |------UDP------| S |
      +---+                | S |               |   |
             /-----TCP-----| G |               +---+
      +---+ /              +---+
      | c |/
      +---+
      example.com       example.com           example.net
      DOTS clients      DOTS gateway (DOTSG)  DOTS server
</pre>
<p class="figure">Figure 7: Client-Side Gateway with Aggregation</p>
<div id="rfc.figure.8"></div>
<div id="fig-client-gateway-noagg"></div>
<pre>
      +---+
      | c |\
      +---+ \              +---+
             \-----TCP-----| D |------UDP------+---+
      +---+                | O |               |   |
      | c |--------TCP-----| T |------UDP------| S |
      +---+                | S |               |   |
             /-----TCP-----| G |------UDP------+---+
      +---+ /              +---+
      | c |/
      +---+
      example.com       example.com           example.net
      DOTS clients      DOTS gateway (DOTSG)  DOTS server
</pre>
<p class="figure">Figure 8: Client-Side Gateway without Aggregation</p>
<p id="rfc.section.2.3.1.p.3">This may similarly be deployed in the inverse scenario where the gateway resides in the server-side domain and may be used to terminate and/or aggregate multiple clients to single transport as shown in figures <a href="#fig-server-gateway-agg" class="xref">Figure 9</a> and <a href="#fig-server-gateway-noagg" class="xref">Figure 10</a>.</p>
<div id="rfc.figure.9"></div>
<div id="fig-server-gateway-agg"></div>
<pre>
      +---+
      | c |\
      +---+ \              +---+
             \-----UDP-----| D |               +---+
      +---+                | O |               |   |
      | c |--------TCP-----| T |------TCP------| S |
      +---+                | S |               |   |
             /-----TCP-----| G |               +---+
      +---+ /              +---+
      | c |/
      +---+
      example.com       example.net           example.net
      DOTS clients      DOTS gateway (DOTSG)  DOTS server
</pre>
<p class="figure">Figure 9: Server-Side Gateway with Aggregation</p>
<div id="rfc.figure.10"></div>
<div id="fig-server-gateway-noagg"></div>
<pre>
      +---+
      | c |\
      +---+ \              +---+
             \-----UDP-----| D |------TCP------+---+
      +---+                | O |               |   |
      | c |--------TCP-----| T |------TCP------| S |
      +---+                | S |               |   |
             /-----UDP-----| G |------TCP------+---+
      +---+ /              +---+
      | c |/
      +---+
      example.com       example.net           example.net
      DOTS clients      DOTS gateway (DOTSG)  DOTS server
</pre>
<p class="figure">Figure 10: Server-Side Gateway without Aggregation</p>
<p id="rfc.section.2.3.1.p.4">This document anticipates scenarios involving multiple DOTS gateways. An example is a DOTS gateway at the network client's side, and another one at the server side. The first gateway can be located at a CPE to aggregate requests from multiple DOTS clients enabled in an enterprise network. The second DOTS gateway is deployed on the provider side. This scenario can be seen as a combination of the client-side and server-side scenarios.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#concepts" id="concepts">Concepts</a>
</h1>
<h2 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#dots-sessions" id="dots-sessions">DOTS Sessions</a>
</h2>
<p id="rfc.section.3.1.p.1">In order for DOTS to be effective as a vehicle for DDoS mitigation requests, one or more DOTS clients must establish ongoing communication with one or more DOTS servers. While the preconditions for enabling DOTS in or among network domains may also involve business relationships, service level agreements, or other formal or informal understandings between network operators, such considerations are out of scope for this document.</p>
<p id="rfc.section.3.1.p.2">A DOTS session is established to support bilateral exchange of data between an associated DOTS client and a DOTS server. In the DOTS architecture, data is exchanged between DOTS agents over signal and data channels. As such, a DOTS session can be a DOTS signal channel session, a DOTS data channel session, or both.</p>
<p id="rfc.section.3.1.p.3">A DOTS agent can maintain one or more DOTS sessions.</p>
<p id="rfc.section.3.1.p.4">A DOTS signal channel session is associated with a single transport connection (TCP or UDP session) and an ephemeral security association (a TLS or DTLS session). Similarly, a DOTS data channel session is associated with a single TCP connection and an ephemeral TLS security association.</p>
<p id="rfc.section.3.1.p.5">Mitigation requests created using DOTS signal channel are not bound to the DOTS signal channel session. Instead, mitigation requests are associated with a DOTS client and can be managed using different DOTS signal channel sessions.</p>
<h3 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#dots-session-preconditions" id="dots-session-preconditions">Preconditions</a>
</h3>
<p id="rfc.section.3.1.1.p.1">Prior to establishing a DOTS session between agents, the owners of the networks, domains, services or applications involved are assumed to have agreed upon the terms of the relationship involved. Such agreements are out of scope for this document, but must be in place for a functional DOTS architecture.</p>
<p id="rfc.section.3.1.1.p.2">It is assumed that as part of any DOTS service agreement, the DOTS client is provided with all data and metadata required to establish communication with the DOTS server. Such data and metadata would include any cryptographic information necessary to meet the message confidentiality, integrity and authenticity requirement (SEC-002) in <a href="#RFC8612" class="xref">[RFC8612]</a>, and might also include the pool of DOTS server addresses and ports the DOTS client should use for signal and data channel messaging.</p>
<h3 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> <a href="#establishing-dots-session" id="establishing-dots-session">Establishing the DOTS Session</a>
</h3>
<p id="rfc.section.3.1.2.p.1">With the required business agreements in place, the DOTS client initiates a DOTS session by contacting its DOTS server(s) over the signal channel and (possibly) the data channel. To allow for DOTS service flexibility, neither the order of contact nor the time interval between channel creations is specified. A DOTS client MAY establish signal channel first, and then data channel, or vice versa.</p>
<p id="rfc.section.3.1.2.p.2">The methods by which a DOTS client receives the address and associated service details of the DOTS server are not prescribed by this document. For example, a DOTS client may be directly configured to use a specific DOTS server IP address and port, and directly provided with any data necessary to satisfy the Peer Mutual Authentication requirement (SEC-001) in <a href="#RFC8612" class="xref">[RFC8612]</a>, such as symmetric or asymmetric keys, usernames and passwords, etc. All configuration and authentication information in this scenario is provided out-of-band by the domain operating the DOTS server.</p>
<p id="rfc.section.3.1.2.p.3">At the other extreme, the architecture in this document allows for a form of DOTS client auto-provisioning. For example, the domain operating the DOTS server or servers might provide the client domain only with symmetric or asymmetric keys to authenticate the provisioned DOTS clients. Only the keys would then be directly configured on DOTS clients, but the remaining configuration required to provision the DOTS clients could be learned through mechanisms similar to DNS SRV <a href="#RFC2782" class="xref">[RFC2782]</a> or DNS Service Discovery <a href="#RFC6763" class="xref">[RFC6763]</a>.</p>
<p id="rfc.section.3.1.2.p.4">The DOTS client SHOULD successfully authenticate and exchange messages with the DOTS server over both signal and (if used) data channel as soon as possible to confirm that both channels are operational.</p>
<p id="rfc.section.3.1.2.p.5">As described in <a href="#RFC8612" class="xref">[RFC8612]</a>  (DM-008), the DOTS client can configure preferred values for acceptable signal loss, mitigation lifetime, and heartbeat intervals when establishing the DOTS signal channel session. A DOTS signal channel session is not active until DOTS agents have agreed on the values for these DOTS session parameters, a process defined by the protocol.</p>
<p id="rfc.section.3.1.2.p.6">Once the DOTS client begins receiving DOTS server signals, the DOTS session is active. At any time during the DOTS session, the DOTS client may use the data channel to manage aliases, manage drop- and accept-listed prefixes or addresses, leverage vendor-specific extensions, and so on. Note that unlike the signal channel, there is no requirement that the data channel remains operational in attack conditions (See Data Channel Requirements, Section 2.3 of <a href="#RFC8612" class="xref">[RFC8612]</a>).</p>
<h3 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> <a href="#maintaining-dots-session" id="maintaining-dots-session">Maintaining the DOTS Session</a>
</h3>
<p id="rfc.section.3.1.3.p.1">DOTS clients and servers periodically send heartbeats to each other over the signal channel, discussed in <a href="#RFC8612" class="xref">[RFC8612]</a>  (SIG-004).  DOTS agent operators SHOULD configure the heartbeat interval such that the frequency does not lead to accidental denials of service due to the overwhelming number of heartbeats a DOTS agent must field.</p>
<p id="rfc.section.3.1.3.p.2">Either DOTS agent may consider a DOTS signal channel session terminated in the extended absence of a heartbeat from its peer agent. The period of that absence will be established in the protocol definition.</p>
<h2 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#modes-of-signaling" id="modes-of-signaling">Modes of Signaling</a>
</h2>
<p id="rfc.section.3.2.p.1">This section examines the modes of signaling between agents in a DOTS architecture.</p>
<h3 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> <a href="#direct-signaling" id="direct-signaling">Direct Signaling</a>
</h3>
<p id="rfc.section.3.2.1.p.1">A DOTS session may take the form of direct signaling between the DOTS clients and servers, as shown in <a href="#fig-direct-signaling" class="xref">Figure 11</a>.</p>
<div id="rfc.figure.11"></div>
<div id="fig-direct-signaling"></div>
<pre>
        +-------------+                            +-------------+
        | DOTS client |&lt;------signal session------&gt;| DOTS server |
        +-------------+                            +-------------+
</pre>
<p class="figure">Figure 11: Direct Signaling</p>
<p id="rfc.section.3.2.1.p.2">In a direct DOTS session, the DOTS client and server are communicating directly.  Direct signaling may exist inter- or intra-domain. The DOTS session is abstracted from the underlying networks or network elements the signals traverse: in direct signaling, the DOTS client and server are logically adjacent.</p>
<h3 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> <a href="#redirected-signaling" id="redirected-signaling">Redirected Signaling</a>
</h3>
<p id="rfc.section.3.2.2.p.1">In certain circumstances, a DOTS server may want to redirect a DOTS client to an alternative DOTS server for a DOTS signal channel session. Such circumstances include but are not limited to:</p>
<p></p>

<ul>
<li>Maximum number of DOTS signal channel sessions with clients has been reached;</li>
<li>Mitigation capacity exhaustion in the mitigator with which the specific DOTS server is communicating;</li>
<li>Mitigator outage or other downtime, such as scheduled maintenance;</li>
<li>Scheduled DOTS server maintenance;</li>
<li>Scheduled modifications to the network path between DOTS server and DOTS client.</li>
</ul>
<p id="rfc.section.3.2.2.p.3">A basic redirected DOTS signal channel session resembles the following, as shown in <a href="#fig-redirected-signaling" class="xref">Figure 12</a>.</p>
<div id="rfc.figure.12"></div>
<div id="fig-redirected-signaling"></div>
<pre>
        +-------------+                            +---------------+
        |             |&lt;-(1)--- DOTS signal ------&gt;|               |
        |             |      channel session 1     |               |
        |             |&lt;=(2)== redirect to B ======|               |
        | DOTS client |                            | DOTS server A |
        |             |X-(4)--- DOTS signal ------X|               |
        |             |      channel session 1     |               |
        |             |                            |               |
        +-------------+                            +---------------+
               ^
               |
              (3) DOTS signal channel
               |      session 2
               v
        +---------------+
        | DOTS server B |
        +---------------+
</pre>
<p class="figure">Figure 12: Redirected Signaling</p>
<p></p>

<ol>
<li>Previously established DOTS signal channel session 1 exists between a DOTS client and DOTS server A.</li>
<li>DOTS server A sends a server signal redirecting the client to DOTS server B.</li>
<li>If the DOTS client does not already have a separate DOTS signal channel session with the redirection target, the DOTS client initiates and establishes DOTS signal channel session 2 with DOTS server B.</li>
<li>Having redirected the DOTS client, DOTS server A ceases sending server signals. The DOTS client likewise stops sending client signals to DOTS server A. DOTS signal channel session 1 is terminated.</li>
</ol>
<h3 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> <a href="#recursive-signaling" id="recursive-signaling">Recursive Signaling</a>
</h3>
<p id="rfc.section.3.2.3.p.1">DOTS is centered around improving the speed and efficiency of coordinated response to DDoS attacks. One scenario not yet discussed involves coordination among federated domains operating DOTS servers and mitigators.</p>
<p id="rfc.section.3.2.3.p.2">In the course of normal DOTS operations, a DOTS client communicates the need for mitigation to a DOTS server, and that server initiates mitigation on a mitigator with which the server has an established service relationship. The operator of the mitigator may in turn monitor mitigation performance and capacity, as the attack being mitigated may grow in severity beyond the mitigating domain's capabilities.</p>
<p id="rfc.section.3.2.3.p.3">The operator of the mitigator has limited options in the event a DOTS client-requested mitigation is being overwhelmed by the severity of the attack.  Out-of-scope business or service level agreements may permit the mitigating domain to drop the mitigation and let attack traffic flow unchecked to the target, but this only encourages attack escalation. In the case where the mitigating domain is the upstream service provider for the attack target, this may mean the mitigating domain and its other services and users continue to suffer the incidental effects of the attack.</p>
<p id="rfc.section.3.2.3.p.4">A recursive signaling model as shown in <a href="#fig-recursive-signaling" class="xref">Figure 13</a> offers an alternative. In a variation of the use case "Upstream DDoS Mitigation by an Upstream Internet Transit Provider" described in <a href="#I-D.ietf-dots-use-cases" class="xref">[I-D.ietf-dots-use-cases]</a>, a domain operating a DOTS server and mitigator also operates a DOTS client. This DOTS client has an established DOTS session with a DOTS server belonging to a separate administrative domain.</p>
<p id="rfc.section.3.2.3.p.5">With these preconditions in place, the operator of the mitigator being overwhelmed or otherwise performing inadequately may request mitigation for the attack target from this separate DOTS-aware domain. Such a request recurses the originating mitigation request to the secondary DOTS server, in the hope of building a cumulative mitigation against the attack.</p>
<div id="rfc.figure.13"></div>
<div id="fig-recursive-signaling"></div>
<pre>
                     example.net domain
                     . . . . . . . . . . . . . . . . .
                     .    Gn                         .
       +----+    1   .  +----+       +-----------+   .
       | Cc |&lt;---------&gt;| Sn |~~~~~~~| Mitigator |   .
       +----+        .  +====+       |     Mn    |   .
                     .  | Cn |       +-----------+   .
     example.com     .  +----+                       .
        client       .    ^                          .
                     . . .|. . . . . . . . . . . . . .
                          |
                        2 |
                          |
                     . . .|. . . . . . . . . . . . . .
                     .    v                          .
                     .  +----+       +-----------+   .
                     .  | So |~~~~~~~| Mitigator |   .
                     .  +----+       |     Mo    |   .
                     .               +-----------+   .
                     .                               .
                     . . . . . . . . . . . . . . . . .
                     example.org domain
</pre>
<p class="figure">Figure 13: Recursive Signaling</p>
<p id="rfc.section.3.2.3.p.6">In <a href="#fig-recursive-signaling" class="xref">Figure 13</a>, client Cc signals a request for mitigation across inter-domain DOTS session 1 to the DOTS server Sn belonging to the example.net domain. DOTS server Sn enables mitigation on mitigator Mn. DOTS server Sn is half of DOTS gateway Gn, being deployed logically back-to-back with DOTS client Cn, which has pre-existing inter-domain DOTS session 2 with the DOTS server So belonging to the example.org domain. At any point, DOTS server Sn MAY recurse an on-going mitigation request through DOTS client Cn to DOTS server So, in the expectation that mitigator Mo will be activated to aid in the defense of the attack target.</p>
<p id="rfc.section.3.2.3.p.7">Recursive signaling is opaque to the DOTS client. To maximize mitigation visibility to the DOTS client, however, the recursing domain SHOULD provide recursed mitigation feedback in signals reporting on mitigation status to the DOTS client. For example, the recursing domain's mitigator should incorporate into mitigation status messages available metrics such as dropped packet or byte counts from the recursed mitigation.</p>
<p id="rfc.section.3.2.3.p.8">DOTS clients involved in recursive signaling must be able to withdraw requests for mitigation without warning or justification, per SIG-006 in <a href="#RFC8612" class="xref">[RFC8612]</a>.</p>
<p id="rfc.section.3.2.3.p.9">Operators recursing mitigation requests MAY maintain the recursed mitigation for a brief, protocol-defined period in the event the DOTS client originating the mitigation withdraws its request for help, as per the discussion of managing mitigation toggling in SIG-006 of <a href="#RFC8612" class="xref">[RFC8612]</a>.</p>
<p id="rfc.section.3.2.3.p.10">Deployment of recursive signaling may result in traffic redirection, examination and mitigation extending beyond the initial bilateral relationship between DOTS client and DOTS server. As such, client control over the network path of mitigated traffic may be reduced. DOTS client operators should be aware of any privacy concerns, and work with DOTS server operators employing recursive signaling to ensure shared sensitive material is suitably protected.</p>
<h3 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> <a href="#anycast-signaling" id="anycast-signaling">Anycast Signaling</a>
</h3>
<p id="rfc.section.3.2.4.p.1">The DOTS architecture does not assume the availability of anycast within a DOTS deployment, but neither does the architecture exclude it. Domains operating DOTS servers MAY deploy DOTS servers with an anycast Service Address as described in BCP 126 <a href="#RFC4786" class="xref">[RFC4786]</a>. In such a deployment, DOTS clients connecting to the DOTS Service Address may be communicating with distinct DOTS servers, depending on the network configuration at the time the DOTS clients connect.  Among other benefits, anycast signaling potentially offers the following:</p>
<p></p>

<ul>
<li>Simplified DOTS client configuration, including service discovery through the methods described in <a href="#RFC7094" class="xref">[RFC7094]</a>. In this scenario, the "instance discovery" message would be a DOTS client initiating a DOTS session to the DOTS server anycast Service Address, to which the DOTS server would reply with a redirection to the DOTS server unicast address the client should use for DOTS.</li>
<li>Region- or customer-specific deployments, in which the DOTS Service Addresses route to distinct DOTS servers depending on the client region or the customer network in which a DOTS client resides.</li>
<li>Operational resiliency, spreading DOTS signaling traffic across the DOTS server domain's networks, and thereby also reducing the potential attack surface, as described in BCP 126 <a href="#RFC4786" class="xref">[RFC4786]</a>.</li>
</ul>
<h4 id="rfc.section.3.2.4.1">
<a href="#rfc.section.3.2.4.1">3.2.4.1.</a> <a href="#anycast-signaling-considerations" id="anycast-signaling-considerations">Anycast Signaling Considerations</a>
</h4>
<p id="rfc.section.3.2.4.1.p.1">As long as network configuration remains stable, anycast DOTS signaling is to the individual DOTS client indistinct from direct signaling. However, the operational challenges inherent in anycast signaling are anything but negligible, and DOTS server operators must carefully weigh the risks against the benefits before deploying.</p>
<p id="rfc.section.3.2.4.1.p.2">While the DOTS signal channel primarily operates over UDP per SIG-001 in <a href="#RFC8612" class="xref">[RFC8612]</a>, the signal channel also requires mutual authentication between DOTS agents, with associated security state on both ends.</p>
<p id="rfc.section.3.2.4.1.p.3">Network instability is of particular concern with anycast signaling, as DOTS signal channels are expected to be long-lived, and potentially operating under congested network conditions caused by a volumetric DDoS attack.</p>
<p id="rfc.section.3.2.4.1.p.4">For example, a network configuration altering the route to the DOTS server during active anycast signaling may cause the DOTS client to send messages to a DOTS server other than the one with which it initially established a signaling session. That second DOTS server may not have the security state of the existing session, forcing the DOTS client to initialize a new DOTS session.  This challenge might in part be mitigated by use of resumption via a PSK in TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> and DTLS 1.3 <a href="#I-D.ietf-tls-dtls13" class="xref">[I-D.ietf-tls-dtls13]</a>  (session resumption in TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a> and DTLS 1.2 <a href="#RFC6347" class="xref">[RFC6347]</a>), but keying material must be available to all DOTS servers sharing the anycast Service Address in that case.</p>
<p id="rfc.section.3.2.4.1.p.5">While the DOTS client will try to establish a new DOTS session with the DOTS server now acting as the anycast DOTS Service Address, the link between DOTS client and server may be congested with attack traffic, making signal session establishment difficult. In such a scenario, anycast Service Address instability becomes a sort of signal session flapping, with obvious negative consequences for the DOTS deployment.</p>
<p id="rfc.section.3.2.4.1.p.6">Anycast signaling deployments similarly must also take into account active mitigations. Active mitigations initiated through a DOTS session may involve diverting traffic to a scrubbing center. If the DOTS session flaps due to anycast changes as described above, mitigation may also flap as the DOTS servers sharing the anycast DOTS service address toggles mitigation on detecting DOTS session loss, depending on whether the client has configured mitigation on loss of signal.</p>
<h3 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> <a href="#nat-signaling" id="nat-signaling">Signaling Considerations for Network Address Translation</a>
</h3>
<p id="rfc.section.3.2.5.p.1">Network address translators (NATs) are expected to be a common feature of DOTS deployments. The Middlebox Traversal Guidelines in <a href="#RFC8085" class="xref">[RFC8085]</a> include general NAT considerations for DOTS deployements when the signal channel is established over UDP.</p>
<p id="rfc.section.3.2.5.p.2">Additional DOTS-specific considerations arise when NATs are part of the DOTS architecture. For example, DDoS attack detection behind a NAT will detect attacks against internal addresses. A DOTS client subsequently asked to request mitigation for the attacked scope of addresses cannot reasonably perform the task, due to the lack of externally routable addresses in the mitigation scope.</p>
<p id="rfc.section.3.2.5.p.3">The following considerations do not cover all possible scenarios, but are meant rather to highlight anticipated common issues when signaling through NATs.</p>
<h4 id="rfc.section.3.2.5.1">
<a href="#rfc.section.3.2.5.1">3.2.5.1.</a> <a href="#direct-provisioning-of-internal-to-external-address-mappings" id="direct-provisioning-of-internal-to-external-address-mappings">Direct Provisioning of Internal-to-External Address Mappings</a>
</h4>
<p id="rfc.section.3.2.5.1.p.1">Operators may circumvent the problem of translating internal addresses or prefixes to externally routable mitigation scopes by directly provisioning the mappings of external addresses to internal protected resources on the DOTS client. When the operator requests mitigation scoped for internal addresses, directly or through automated means, the DOTS client looks up the matching external addresses or prefixes, and issues a mitigation request scoped to that externally routable information.</p>
<p id="rfc.section.3.2.5.1.p.2">When directly provisioning the address mappings, operators must ensure the mappings remain up to date, or risk losing the ability to request accurate mitigation scopes. To that aim, the DOTS client can rely on mechanisms, such as <a href="#RFC8512" class="xref">[RFC8512]</a> to retrieve static explicit mappings. This document does not prescribe the method by which mappings are maintained once they are provisioned on the DOTS client.</p>
<h4 id="rfc.section.3.2.5.2">
<a href="#rfc.section.3.2.5.2">3.2.5.2.</a> <a href="#resolving-public-mitigation-scope-with-port-control-protocol-pcp" id="resolving-public-mitigation-scope-with-port-control-protocol-pcp">Resolving Public Mitigation Scope with Port Control Protocol (PCP)</a>
</h4>
<p id="rfc.section.3.2.5.2.p.1">Port Control Protocol (PCP) <a href="#RFC6887" class="xref">[RFC6887]</a> may be used to retrieve the external addresses/prefixes and/or port numbers if the NAT function embeds a PCP server.</p>
<p id="rfc.section.3.2.5.2.p.2">A DOTS client can use the information retrieved by means of PCP to feed the DOTS protocol(s) messages that will be sent to a DOTS server. These messages will convey the external addresses/prefixes as set by the NAT.</p>
<p id="rfc.section.3.2.5.2.p.3">PCP also enables discovery and configuration of the lifetime of port mappings instantiated in intermediate NAT devices. Discovery of port mapping lifetimes can reduce the dependency on heartbeat messages to maintain mappings, and therefore reduce the load on DOTS servers and the network.</p>
<h4 id="rfc.section.3.2.5.3">
<a href="#rfc.section.3.2.5.3">3.2.5.3.</a> <a href="#resolving-public-mitigation-scope-with-session-traversal-utilities-stun" id="resolving-public-mitigation-scope-with-session-traversal-utilities-stun">Resolving Public Mitigation Scope with Session Traversal Utilities (STUN)</a>
</h4>
<p id="rfc.section.3.2.5.3.p.1">An internal resource, e.g., a Web server, can discover its reflexive transport address through a STUN Binding request/response transaction, as described in <a href="#RFC5389" class="xref">[RFC5389]</a>. After learning its reflexive transport address from the STUN server, the internal resource can export its reflexive transport address and internal transport address to the DOTS client, thereby enabling the DOTS client to request mitigation with the correct external scope, as depicted in <a href="#fig-nat-stun" class="xref">Figure 14</a>. The mechanism for providing the DOTS client with the reflexive transport address and internal transport address is unspecified in this document.</p>
<p id="rfc.section.3.2.5.3.p.2">In order to prevent an attacker from modifying the STUN messages in transit, the STUN client and server MUST use the message-integrity mechanism discussed in Section 10 of <a href="#RFC5389" class="xref">[RFC5389]</a> or use STUN over DTLS <a href="#RFC7350" class="xref">[RFC7350]</a> or use STUN over TLS.  If the STUN client is behind a NAT that performs Endpoint-Dependent Mapping <a href="#RFC5128" class="xref">[RFC5128]</a>, the internal service cannot provide the DOTS client with the reflexive transport address discovered using STUN. The behavior of a NAT between the STUN client and the STUN server could be discovered using the experimental techniques discussed in <a href="#RFC5780" class="xref">[RFC5780]</a>, but note that there is currently no standardized way for a STUN client to reliably determine if it is behind a NAT that performs Endpoint-Dependent Mapping.</p>
<div id="rfc.figure.14"></div>
<div id="fig-nat-stun"></div>
<pre>
                Binding         Binding
    +--------+  request  +---+  request  +--------+
    |  STUN  |&lt;----------| N |&lt;----------|  STUN  |
    | server |           | A |           | client |
    |        |----------&gt;| T |----------&gt;|        |
    +--------+  Binding  +---+  Binding  +--------+
                response        response    |
                                            | reflexive transport address
                                            | &amp; internal transport address
                                            v
                                         +--------+
                                         |  DOTS  |
                                         | client |
                                         +--------+
</pre>
<p class="figure">Figure 14: Resolving mitigation scope with STUN</p>
<h4 id="rfc.section.3.2.5.4">
<a href="#rfc.section.3.2.5.4">3.2.5.4.</a> <a href="#resolving-requested-mitigation-scope-with-dns" id="resolving-requested-mitigation-scope-with-dns">Resolving Requested Mitigation Scope with DNS</a>
</h4>
<p id="rfc.section.3.2.5.4.p.1">DOTS supports mitigation scoped to DNS names. As discussed in <a href="#RFC3235" class="xref">[RFC3235]</a>, using DNS names instead of IP addresses potentially avoids the address translation problem, as long as the name is internally and externally resolvable by the same name. For example, a detected attack's internal target address can be mapped to a DNS name through a reverse lookup. The DNS name returned by the reverse lookup can then be provided to the DOTS client as the external scope for mitigation. For the reverse DNS lookup, DNS Security Extensions (DNSSEC) <a href="#RFC4033" class="xref">[RFC4033]</a> must be used  where the authenticity of response is critical.</p>
<h2 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#mit-request-triggers" id="mit-request-triggers">Triggering Requests for Mitigation</a>
</h2>
<p><a href="#RFC8612" class="xref">[RFC8612]</a> places no limitation on the circumstances in which a DOTS client operator may request mitigation, nor does it demand justification for any mitigation request, thereby reserving operational control over DDoS defense for the domain requesting mitigation. This architecture likewise does not prescribe the network conditions and mechanisms triggering a mitigation request from a DOTS client.</p>
<p id="rfc.section.3.3.p.2">However, considering selected possible mitigation triggers from an architectural perspective offers a model for alternative or unanticipated triggers for DOTS deployments. In all cases, what network conditions merit a mitigation request are at the discretion of the DOTS client operator.</p>
<p id="rfc.section.3.3.p.3">The mitigation request itself is defined by DOTS, however the interfaces required to trigger the mitigation request in the following scenarios are implementation-specific.</p>
<h3 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#manual-mit-request" id="manual-mit-request">Manual Mitigation Request</a>
</h3>
<p id="rfc.section.3.3.1.p.1">A DOTS client operator may manually prepare a request for mitigation, including scope and duration, and manually instruct the DOTS client to send the mitigation request to the DOTS server. In context, a manual request is a request directly issued by the operator without automated decision-making performed by a device interacting with the DOTS client. Modes of manual mitigation requests include an operator entering a command into a text interface, or directly interacting with a graphical interface to send the request.</p>
<p id="rfc.section.3.3.1.p.2">An operator might do this, for example, in response to notice of an attack delivered by attack detection equipment or software, and the alerting detector lacks interfaces or is not configured to use available interfaces to translate the alert to a mitigation request automatically.</p>
<p id="rfc.section.3.3.1.p.3">In a variation of the above scenario, the operator may have preconfigured on the DOTS client mitigation requests for various resources in the operator's domain.  When notified of an attack, the DOTS client operator manually instructs the DOTS client to send the relevant preconfigured mitigation request for the resources under attack.</p>
<p id="rfc.section.3.3.1.p.4">A further variant involves recursive signaling, as described in <a href="#recursive-signaling" class="xref">Section 3.2.3</a>. The DOTS client in this case is the second half of a DOTS gateway (back-to-back DOTS server and client). As in the previous scenario, the scope and duration of the mitigation request are pre-existing, but in this case are derived from the mitigation request received from a downstream DOTS client by the DOTS server. Assuming the preconditions required by <a href="#recursive-signaling" class="xref">Section 3.2.3</a> are in place, the DOTS gateway operator may at any time manually request mitigation from an upstream DOTS server, sending a mitigation request derived from the downstream DOTS client's request.</p>
<p id="rfc.section.3.3.1.p.5">The motivations for a DOTS client operator to request mitigation manually are not prescribed by this architecture, but are expected to include some of the following:</p>
<p></p>

<ul>
<li>Notice of an attack delivered via e-mail or alternative messaging</li>
<li>Notice of an attack delivered via phone call</li>
<li>Notice of an attack delivered through the interface(s) of networking monitoring software deployed in the operator's domain</li>
<li>Manual monitoring of network behavior through network monitoring software</li>
</ul>
<h3 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> <a href="#auto-conditional-mit" id="auto-conditional-mit">Automated Conditional Mitigation Request</a>
</h3>
<p id="rfc.section.3.3.2.p.1">Unlike manual mitigation requests, which depend entirely on the DOTS client operator's capacity to react with speed and accuracy to every detected or detectable attack, mitigation requests triggered by detected attack conditions reduce the operational burden on the DOTS client operator, and minimize the latency between attack detection and the start of mitigation.</p>
<p id="rfc.section.3.3.2.p.2">Mitigation requests are triggered in this scenario by operator-specified network conditions. Attack detection is deployment-specific, and not constrained by this architecture. Similarly the specifics of a condition are left to the discretion of the operator, though common conditions meriting mitigation include the following:</p>
<p></p>

<ul>
<li>Detected attack exceeding a rate in packets per second (pps).</li>
<li>Detected attack exceeding a rate in bytes per second (bps).</li>
<li>Detected resource exhaustion in an attack target.</li>
<li>Detected resource exhaustion in the local domain's mitigator.</li>
<li>Number of open connections to an attack target.</li>
<li>Number of attack sources in a given attack.</li>
<li>Number of active attacks against targets in the operator's domain.</li>
<li>Conditional detection developed through arbitrary statistical analysis or deep learning techniques.</li>
<li>Any combination of the above.</li>
</ul>
<p id="rfc.section.3.3.2.p.4">When automated conditional mitigation requests are enabled, violations of any of the above conditions, or any additional operator-defined conditions, will trigger a mitigation request from the DOTS client to the DOTS server. The interfaces between the application detecting the condition violation and the DOTS client are implementation-specific.</p>
<h3 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> <a href="#auto-mit-signal-loss" id="auto-mit-signal-loss">Automated Mitigation on Loss of Signal</a>
</h3>
<p id="rfc.section.3.3.3.p.1">To maintain a DOTS signal channel session, the DOTS client and the DOTS server exchange regular but infrequent messages across the signal channel. In the absence of an attack, the probability of message loss in the signaling channel should be extremely low. Under attack conditions, however, some signal loss may be anticipated as attack traffic congests the link, depending on the attack type.</p>
<p id="rfc.section.3.3.3.p.2">While <a href="#RFC8612" class="xref">[RFC8612]</a> specifies the DOTS protocol be robust when signaling under attack conditions, there are nevertheless scenarios in which the DOTS signal is lost in spite of protocol best efforts. To handle such scenarios, a DOTS operator may request one or more mitigations which are triggered only when the DOTS server ceases receiving DOTS client heartbeats beyond the miss count or interval permitted by the protocol.</p>
<p id="rfc.section.3.3.3.p.3">The impact of mitigating due to loss of signal in either direction must be considered carefully before enabling it. Signal loss is not caused by links congested with attack traffic alone, and as such mitigation requests triggered by signal channel degradation in either direction may incur unnecessary costs, in network performance and operational expense alike.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.4.p.1">This document has no actions for IANA.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This section describes identified security considerations for the DOTS architecture.</p>
<p id="rfc.section.5.p.2">DOTS is at risk from three primary attack vectors:  agent impersonation, traffic injection and signal blocking.  These vectors may be exploited individually or in concert by an attacker to confuse, disable, take information from, or otherwise inhibit DOTS agents.</p>
<p id="rfc.section.5.p.3">Any attacker with the ability to impersonate a legitimate DOTS client or server or, indeed, inject false messages into the stream may potentially trigger/withdraw traffic redirection, trigger/cancel mitigation activities or subvert drop-/accept-lists.  From an architectural standpoint, operators SHOULD ensure best current practices for secure communication are observed for data and signal channel confidentiality, integrity and authenticity.  Care must be taken to ensure transmission is protected by appropriately secure means, reducing attack surface by exposing only the minimal required services or interfaces.  Similarly, received data at rest SHOULD be stored with a satisfactory degree of security.</p>
<p id="rfc.section.5.p.4">As many mitigation systems employ diversion to scrub attack traffic, operators of DOTS agents SHOULD ensure DOTS sessions are resistant to Man-in-the-Middle (MitM) attacks. An attacker with control of a DOTS client may negatively influence network traffic by requesting and withdrawing requests for mitigation for particular prefixes, leading to route or DNS flapping.</p>
<p id="rfc.section.5.p.5">Any attack targeting the availability of DOTS servers may disrupt the ability of the system to receive and process DOTS signals resulting in failure to fulfill a mitigation request.  DOTS agents SHOULD be given adequate protections, again in accordance with best current practices for network and host security.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#contributors" id="contributors">Contributors</a>
</h1>
<p></p>

<dl>
<dt>Mohamed Boucadair</dt>
<dd style="margin-left: 8">
<br> Orange</dd>
<dt></dt>
<dd style="margin-left: 8">mohamed.boucadair@orange.com</dd>
</dl>
<p></p>

<dl>
<dt>Christopher Gray</dt>
<dd style="margin-left: 8">Christopher_Gray3@cable.comcast.com</dd>
</dl>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.7.p.1">Thanks to Matt Richardson, Roman Danyliw, Frank Xialiang, Roland Dobbins, Wei Pan, Kaname Nishizuka, Jon Shallow, and Mohamed Boucadair for their comments and suggestions.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h2 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
</tbody></table>
<h2 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-dots-use-cases">[I-D.ietf-dots-use-cases]</b></td>
<td class="top">
<a>Dobbins, R.</a>, <a>Migault, D.</a>, <a>Fouant, S.</a>, <a>Moskowitz, R.</a>, <a>Teague, N.</a>, <a>Xia, L.</a> and <a>K. Nishizuka</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dots-use-cases-17">Use cases for DDoS Open Threat Signaling</a>", Internet-Draft draft-ietf-dots-use-cases-17, January 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</b></td>
<td class="top">
<a>Rescorla, E.</a>, <a>Tschofenig, H.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls13-31">The Datagram Transport Layer Security (DTLS) Protocol Version 1.3</a>", Internet-Draft draft-ietf-tls-dtls13-31, March 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0768">[RFC0768]</b></td>
<td class="top">
<a>Postel, J.</a>, "<a href="https://tools.ietf.org/html/rfc768">User Datagram Protocol</a>", STD 6, RFC 768, DOI 10.17487/RFC0768, August 1980.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0793">[RFC0793]</b></td>
<td class="top">
<a>Postel, J.</a>, "<a href="https://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>", STD 7, RFC 793, DOI 10.17487/RFC0793, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a>Gulbrandsen, A.</a>, <a>Vixie, P.</a> and <a>L. Esibov</a>, "<a href="https://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, DOI 10.17487/RFC2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3235">[RFC3235]</b></td>
<td class="top">
<a>Senie, D.</a>, "<a href="https://tools.ietf.org/html/rfc3235">Network Address Translator (NAT)-Friendly Application Design Guidelines</a>", RFC 3235, DOI 10.17487/RFC3235, January 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3261">[RFC3261]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a>, <a>Camarillo, G.</a>, <a>Johnston, A.</a>, <a>Peterson, J.</a>, <a>Sparks, R.</a>, <a>Handley, M.</a> and <a>E. Schooler</a>, "<a href="https://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>", RFC 3261, DOI 10.17487/RFC3261, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="https://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, DOI 10.17487/RFC4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4271">[RFC4271]</b></td>
<td class="top">
<a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="https://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, DOI 10.17487/RFC4271, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4732">[RFC4732]</b></td>
<td class="top">
<a>Handley, M.</a>, <a>Rescorla, E.</a> and <a>IAB</a>, "<a href="https://tools.ietf.org/html/rfc4732">Internet Denial-of-Service Considerations</a>", RFC 4732, DOI 10.17487/RFC4732, December 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4786">[RFC4786]</b></td>
<td class="top">
<a>Abley, J.</a> and <a>K. Lindqvist</a>, "<a href="https://tools.ietf.org/html/rfc4786">Operation of Anycast Services</a>", BCP 126, RFC 4786, DOI 10.17487/RFC4786, December 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5128">[RFC5128]</b></td>
<td class="top">
<a>Srisuresh, P.</a>, <a>Ford, B.</a> and <a>D. Kegel</a>, "<a href="https://tools.ietf.org/html/rfc5128">State of Peer-to-Peer (P2P) Communication across Network Address Translators (NATs)</a>", RFC 5128, DOI 10.17487/RFC5128, March 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5389">[RFC5389]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Mahy, R.</a>, <a>Matthews, P.</a> and <a>D. Wing</a>, "<a href="https://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>", RFC 5389, DOI 10.17487/RFC5389, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5780">[RFC5780]</b></td>
<td class="top">
<a>MacDonald, D.</a> and <a>B. Lowekamp</a>, "<a href="https://tools.ietf.org/html/rfc5780">NAT Behavior Discovery Using Session Traversal Utilities for NAT (STUN)</a>", RFC 5780, DOI 10.17487/RFC5780, May 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6347">[RFC6347]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/rfc6347">Datagram Transport Layer Security Version 1.2</a>", RFC 6347, DOI 10.17487/RFC6347, January 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6763">[RFC6763]</b></td>
<td class="top">
<a>Cheshire, S.</a> and <a>M. Krochmal</a>, "<a href="https://tools.ietf.org/html/rfc6763">DNS-Based Service Discovery</a>", RFC 6763, DOI 10.17487/RFC6763, February 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6887">[RFC6887]</b></td>
<td class="top">
<a>Wing, D.</a>, <a>Cheshire, S.</a>, <a>Boucadair, M.</a>, <a>Penno, R.</a> and <a>P. Selkirk</a>, "<a href="https://tools.ietf.org/html/rfc6887">Port Control Protocol (PCP)</a>", RFC 6887, DOI 10.17487/RFC6887, April 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7092">[RFC7092]</b></td>
<td class="top">
<a>Kaplan, H.</a> and <a>V. Pascual</a>, "<a href="https://tools.ietf.org/html/rfc7092">A Taxonomy of Session Initiation Protocol (SIP) Back-to-Back User Agents</a>", RFC 7092, DOI 10.17487/RFC7092, December 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7094">[RFC7094]</b></td>
<td class="top">
<a>McPherson, D.</a>, <a>Oran, D.</a>, <a>Thaler, D.</a> and <a>E. Osterweil</a>, "<a href="https://tools.ietf.org/html/rfc7094">Architectural Considerations of IP Anycast</a>", RFC 7094, DOI 10.17487/RFC7094, January 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7350">[RFC7350]</b></td>
<td class="top">
<a>Petit-Huguenin, M.</a> and <a>G. Salgueiro</a>, "<a href="https://tools.ietf.org/html/rfc7350">Datagram Transport Layer Security (DTLS) as Transport for Session Traversal Utilities for NAT (STUN)</a>", RFC 7350, DOI 10.17487/RFC7350, August 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8085">[RFC8085]</b></td>
<td class="top">
<a>Eggert, L.</a>, <a>Fairhurst, G.</a> and <a>G. Shepherd</a>, "<a href="https://tools.ietf.org/html/rfc8085">UDP Usage Guidelines</a>", BCP 145, RFC 8085, DOI 10.17487/RFC8085, March 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8446">[RFC8446]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc8446">The Transport Layer Security (TLS) Protocol Version 1.3</a>", RFC 8446, DOI 10.17487/RFC8446, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8512">[RFC8512]</b></td>
<td class="top">
<a>Boucadair, M.</a>, <a>Sivakumar, S.</a>, <a>Jacquenet, C.</a>, <a>Vinapamula, S.</a> and <a>Q. Wu</a>, "<a href="https://tools.ietf.org/html/rfc8512">A YANG Module for Network Address Translation (NAT) and Network Prefix Translation (NPT)</a>", RFC 8512, DOI 10.17487/RFC8512, January 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8612">[RFC8612]</b></td>
<td class="top">
<a>Mortensen, A.</a>, <a>Reddy, T.</a> and <a>R. Moskowitz</a>, "<a href="https://tools.ietf.org/html/rfc8612">DDoS Open Threat Signaling (DOTS) Requirements</a>", RFC 8612, DOI 10.17487/RFC8612, May 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andrew Mortensen</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Mortensen</span>
	  </span>
	</span>
	<span class="org vcardline">Forcepoint</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:andrewmortensen@gmail.com">andrewmortensen@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tirumaleswar Reddy</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Reddy</span>
	  </span>
	</span>
	<span class="org vcardline">McAfee, Inc.</span>
	<span class="adr">
	  <span class="vcardline">Embassy Golf Link Business Park</span>

	  <span class="vcardline">
		<span class="locality">Bangalore, Karnataka</span>,  
		<span class="region"></span>
		<span class="code">560071</span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:kondtir@gmail.com">kondtir@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Flemming Andreasen</span> 
	  <span class="n hidden">
		<span class="family-name">Andreasen</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:fandreas@cisco.com">fandreas@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nik Teague</span> 
	  <span class="n hidden">
		<span class="family-name">Teague</span>
	  </span>
	</span>
	<span class="org vcardline">Iron Mountain</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:nteague@ironmountain.co.uk">nteague@ironmountain.co.uk</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rich Compton</span> 
	  <span class="n hidden">
		<span class="family-name">Compton</span>
	  </span>
	</span>
	<span class="org vcardline">Charter</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Rich.Compton@charter.com">Rich.Compton@charter.com</a></span>

  </address>
</div>

</body>
</html>
